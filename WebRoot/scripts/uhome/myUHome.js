var prot = "<h4>甲方：真格网用户</h4> <h4>乙方：北京真格在线科技有限公司</h4> <h4>丙方：一路财富（北京）信息科技有限公司</h4> <p>U房宝份额支付服务协议（下称“本协议”）是在真格网（www.zhengor.com）注册的用户（下称“甲方”，包括房屋出租方与房屋承租方）、北京真格在线科技有限公司（下称“乙方”）以及一路财富（北京）信息科技有限公司（下称“丙方”）就甲方接受丙方提供的货币基金份额支付服务（包括购买、赎回份额等，详见“定义”），使用房屋承租方持有的U房宝货币基金份额（下称“U房宝”）向与其达成租赁关系的房屋出租方支付租金所订立的有效合约。 甲方通过在真格网上乙方、丙方的合作界面点击确认或以其他方式选择接受本协议，即表示甲方与乙方、丙方已达成协议并同意接受本协议的全部约定以及与本协议有关的各项规则及乙方、丙方网站所包含的其他与本协议或本协议项下各项规则的条款和条件有关的各项规定。</p> <p>在接受本协议之前，请甲方仔细阅读本协议的全部内容。如果甲方不同意本协议的任意内容，或者无法准确理解乙方对条款的解释，请不要进行后续操作。</p> <h4>一、定义</h4> <p>除本协议另有规定外，下列用语具有如下含义：</p> <p>1、货币基金份额支付服务/U房宝支付服务：指丙方借助其与各基金公司的基金支付业务合作，为房屋承租方进行相关理财产品（包括但不限于保险、基金、股票、债券等，下同）交易资金的划转、向符合条件的房屋出租方支付租金及在线进行理财产品交易、信息查询等服务。甲方可通过真格网查询交易明细等信息。</p> <p>2、身份认证要素：指在交易中丙方用于识别甲方身份的信息要素，包括但不限于甲方的商户账户、密码、数字证书、短信校验服务、签约时设置的电话号码、手机号码、甲方银行卡信息、银行预留手机号、银行卡密码等及乙方认可的其他要素。</p> <h4>二、各方权利义务</h4> <p>1、乙方应通过真格网采取必要手段在形式上对甲方进行身份、租赁交易验证（包括但不限于要求甲方填写身份信息、验证手机、邮箱、提交证照复印件、租赁合同复印件、房屋出租方的身份及收款账号等），并根据甲方提交的资料标记各项要素验证情况。乙方应确保仅有通过真格网前述身份、租赁交易验证的用户方有权使用U房宝支付服务。为保障甲方资金安全，乙方有权根据甲方类别、身份认证措施、交易风险度等因素的不同设定不同的安全策略。丙方有权不定期抽验乙方网站的验证流程、安全性，并根据抽验情况要求乙方提高安全策略。</p> <p>2、身份认证要素是乙方、丙方识别甲方的依据，甲方必须妥善保管，不得将身份认证要素提供给任何第三方或交于任何第三方使用。使用上述身份认证要素所发出的一切指令均视为甲方本人亲自所为，甲方应对此产生的后果负责。对非乙、丙方原因造成的账户、密码等信息被冒用、盗用或非法使用，由此引起的一切风险、责任、损失、费用等应由甲方自行承担。</p> <p>3、通过身份、租赁交易验证的房屋承租方通过乙方、丙方的合作界面提交U房宝支付指令后，乙方应将该支付指令即时传送到丙方的服务系统。丙方作为U房宝支付服务的后台操作方，仅根据房屋承租方发出的支付指令进行份额支付租金的操作，就支付指令的真实性、合法性和有效性，乙方、丙方均不负责。支付订单是否真实有效、合法由房屋承租方自行承担责任。与房屋租赁有关的服务事宜由乙方负责，与货币基金支付有关的售后服务由丙方负责。</p> <p>4、甲方知晓并同意，为协助向甲方提供U房宝支付服务及保证甲方顺利使用真格网其他功能，乙方有权按照丙方需要将甲方的个人信息（包括但不限于姓名、身份证号、手机号、邮箱、联系地址）以及房屋租赁交易文件提供给丙方。甲方同意丙方有权将甲方的个人信息（包括但不限于甲方在金融机构的账户、交易信息、资产状况等）以及房屋租赁交易文件提供给乙方。如甲方就房屋租赁交易文件负有保密义务的，甲方应自行与第三方协商，就甲方向乙方、丙方披露房屋租赁交易文件事宜，乙方、丙方无义务承担任何责任。</p> <p>5、房屋承租方知晓并同意，房屋承租方在真格网提交的U房宝支付指令及相关数据，最终以银行系统及丙方的系统记录为准；甲方在真格网可以同步查询到U房宝支付指令的相关数据，但该等数据仅供甲方参考。</p> <p>6、乙方、丙方仅向甲方提供本协议相关服务，而并非U房宝支付服务所涉及各项理财产品购销协议的参与方，不对理财产品购销协议双方的任何口头、书面陈述或者向上传的线上信息之真实性、合法性做任何明示或暗示的担保，或对此承担任何连带责任。乙方、丙方亦无义务参与理财产品购销协议交易资金划转及支付环节之外的任何赔偿、纠纷处理等活动。</p> <p>7、乙方负有形式审核房屋承租方和房屋承租方指定的货币基金份额受让方即房屋出租方的身份验证信息的义务，并确保身份验证信息的形式完备性。乙方应向丙方提交房屋承租方在真格网所填写的房屋出租方的身份信息，使丙方可以验证货币基金份额受让方对应的房屋出租方的准确性。如因房屋承租方U房宝支付指令错误或指定的货币基金份额受让方与房屋承租方在真格网预留的出租方信息不符导致支付失败或资金损失或发生纠纷的，由房屋承租方自行承担相应责任，与乙方、丙方无关。</p> <p>8、甲方授权在乙方开通U房宝支付服务的同时，将U房宝余额增加为房屋承租方提供的在线支付的扣款资金渠道之一，即：房屋承租方同意用所持有的货币基金份额进行支付。但房屋出租方通过乙方、丙方的合作界面开通“U房宝”账户，方可接受货币基金过户。如房屋出租方实际未开通“U房宝”账户的，甲方（房屋承租方）无法使用U房宝支付服务；</p> <p>9、甲方理解并同意，乙方有权根据实际情况在提供具体代扣服务时自行决定U房宝余额在扣款资金渠道中的顺位，具体以页面提示或乙方网站的相关规则、解释为准。</p> <p>10、房屋承租方理解并同意，当房屋承租方选择U房宝余额支付时，即会触发U房宝余额支付的申请。房屋承租方发出“支付”指令后，若该等申请符合业务规则的相关规定，则丙方应于当日受理，同时用于支付的相应份额将于转账流程用户发出转账指令后【t+2】个工作日内过户给与房屋承租方形成租赁关系的房屋出租方收款，房屋出租方可根据受让的货币基金份额自行进行赎回处理。从房屋承租方提交份额支付申请之日（自然日，含当日）起，到对应货币基金份额过户时，基金份额损益归货币基金合法所有方，房屋承租方将不再承担/享有对应的U房宝货币基金份额的损益。</p> <p>11、丙方应将提供份额支付业务服务的开放时间在乙方网站公布，并在有合理理由情形下决定相应调整上述开放时间。在有合理理由情形下，丙方可调整U房宝份额支付中设定的每个投资者单笔、单日、单月限额以及总额限额，如当日份额支付总额超过设定的限额，丙方可临时暂停份额支付业务，并在给甲方和乙方造成最小影响的前提下视情况及时恢复该业务。</p> <p>12、如因甲方的原因，包括但不限于有权机关要求冻结、扣划货币基金份额、账户信息有误等情形，导致用于U房宝支付的份额赎回申请不能及时被确认，过户给房屋出租方的份额赎回款不能到账，或由于乙方、丙方之外的其他原因导致过户份额赎回款不能及时到账等情况，甲方应自行承担责任。</p> <p>13、甲方理解并同意，甲方使用丙方提供的货币基金份额支付服务时，丙方仅作为份额支付服务提供方，如因下列情形导致甲方损失的，乙方、丙方均不承担责任： </p> <p class='in'>（1）法律、政策重大变化，或因乙方、丙方或者丙方对应的基金公司、银行系统故障、系统升级，或丙方合作的划款银行或者支付机构暂停服务，或自然灾害等不可抗力事件，或其他不可预见的非常情况，或云计算中心、网络、通讯故障等丙方不可预测或控制的因素导致过户份额对应的款项无法按期向房屋出租方划付的。</p> <p class='in'>（2）因甲方对设备的错误操作和对有关信息的错误理解导致甲方损失的。</p> <p class='in'>（3）因非乙方、丙方原因造成甲方交易密码等重要信息泄露或遗失导致甲方损失的。</p> <p class='in'>（4）甲方开通U房宝账户时应提供真实、有效、合法的身份信息。甲方使用U房宝支付服务的全部指令均系自主行为。因信息错误或指令错误或房屋出租方未开通U房宝账户等导致的支付错误或失败的，乙方、丙方无需承担任何责任。</p> <p class='in'>（5）丙方仅为甲方提供货币基金支付功能，并不实际参与房屋租赁交易，前端交易产生任何纠纷或被认定无效、撤销的，已发生的货币基金支付行为效力不受影响，任何一方不得向丙方主张任何债权、赔偿；</p> <p>14、丙方承诺其为经中国证券监督管理委员会核准的具备基金销售资格的经营主体，并有义务确保在合作期内确保其基金销售资格或经主管政府部门调整的其他资格持续合法有效。</p> <p>15、丙方同意独立向甲方承担本协议规定的货币基金份额销售方面的义务和责任，但本协议规定的甲方或乙方应承担的义务除外。</p> <h4>三、服务对象范围</h4> <p>1、U房宝支付服务仅向中华人民共和国国籍、年满18周岁、具有完全民事权利能力和民事行为能力且通过实名账户的大陆居民提供。甲方必须按照乙方、丙方网站的注册要求提供本人真实、准确及完整的信息，并负责对本人信息及时更新。乙方视本网站所有成功注册U房宝的用户已就上述各项条件与要求作出承诺，保证本人身份的合法性，以及所提供信息的真实性、准确性、完整性和有效性。</p> <p>2、若甲方提供任何不真实、不准确、不完整或过时的身份信息，或者乙方、丙方有合理理由怀疑甲方所提供的信息为不真实、不准确、不完整或过时的，乙方、丙方的任何一方有权中止（或终止）向甲方提供服务，并拒绝甲方现在或未来使用各项服务之全部或部分功能，对此乙方不承担任何责任。同时，因此所产生的任何直接或间接的支出、损失、费用、处罚将由甲方来承担。若由于甲方未及时更新甲方信息，而导致本服务无法提供或本服务的有关流程及操作发生任何错误，甲方不得以此为由取消交易、拒绝支付/接收交易款项和服务手续费（如有）或采取其它不当行为，并将独立承担因此产生的所有责任和后果。</p> <p>3、但乙方中止（或终止）向甲方提供服务，并拒绝甲方现在或未来使用各项服务之全部或部分功能的，应于采取中止（或终止）服务措施前及时通知丙方停止甲方支付操作。乙方通知丙方之前，丙方已经完成支付操作的，给丙方造成的相应损失由乙方承担相应赔偿责任；乙方通知丙方后，丙方未立即停止甲方支付操作，从而给甲方或乙方造成损失的，由丙方承担相应的赔偿责任。</p> <h4>四、通知</h4> <p>关于本协议条款和其他协议、告示或其他有关甲方使用U房宝服务的通知，乙方将以在真格网显著位置发布公告、发送手机短信或电子邮件、电话通知、挂号信、快递等形式通知甲方，甲方接收乙方、丙方通知的联系方式为甲方在真格网注册及更新时提供的手机号码、电子邮箱、通讯地址等信息（以最后更新内容为准）。通知发出当日视为送达。乙方、丙方之间因履行本协议或补充协议而向对方发出的通知或文件，将通过向指定邮箱发送电子邮件、传真、快递等书面形式进行。</p> <h4>五、服务费用</h4> <p>甲方知晓并同意，乙方、丙方保留向甲方收取服务费的权利。一旦乙方或丙方确定收取或调整服务费收取方式及标准，将以在乙方网站发布公告的方式通知甲方，而不再个别通知。</p> <h4>六、一般规定</h4> <p>1、本协议与真格网网站上其他条款和规则的名词解释、意思理解，可互相引用参照，如有不同理解，应以本协议为准。本协议未做规定的，以真格网网站上不时更新的《U房宝份额服务协议》为准。</p> <p>2、如果本协议条款中的部分条款被有管辖权的法院认定为违法，则并不影响其他条款的有效性。</p> <p>3、乙方保有制定和单方随时修改包括但不限于上述规则的各项规则的权利。所有规则均构成本协议的有效组成部分。新制定和经修改的规则将在乙方网站上进行公布，不做逐一通知。新制定和经修改的规则一旦公布则立即生效，且对生效之日前完成注册的甲方同样适用。但乙方新制定、修改的规则未经丙方书面确认前，对丙方不产生约束力。</p> <p>4、如果甲方就U房宝支付服务中所涉及相关事宜（包括但不限于支付、资金流转、货币基金消费、资金及收益查询等）有任何疑问的，甲方可登陆真格网或拨打乙方、丙方客服热线咨询，乙方客服热线号码为400-115-6080，丙方客服热线号码为【400-001-1566 】。</p> <h4>七、法律适用</h4> <p>1、因本协议引起的或与本协议有关的争议，均适用中华人民共和国法律；</p> <p>2、本协议在北京市西城区签订。</p> <p>3、因本协议引起的或与本协议有关的争议，各方应协商解决。30日内协商不成的，任何一方均有权向本协议签订地的人民法院提起诉讼。</p><button type='button' class='btn btn-primary' id='isee'>我已了解</button>";

$(function() {
	// 显示我的财富
//	$.ajax({
//		url: "/UHomeFund.action?myWealth",
//		dataType: "json",
//		type: "post",
//		cache: false,
//		success: function(data) {
//			if(data.status == "1"){
//				$("#myWealth").text("¥"+data.myWealth);
//				$("#totalProfit").text("¥"+data.totalProfit);
//			}else if(data.status == "0"){
//				$("#myWealth").text("¥0.00");
//				$("#totalProfit").text("¥0.00");
//			}else{
//				$("#myWealth").text("加载失败");
//				$("#totalProfit").text("加载失败");
//			}
//		},
//		error: function(error){
//			$("#myWealth").text("加载失败");
//			$("#totalProfit").text("加载失败");
//		}
//	});
	
	// 申请借款点击事件
	$("#uHomePlanCreateBtnB").click(function(){
		alertDialog("该功能暂未开放，敬请期待！");
	});
		
	// 创建房租计划点击事件
	$("#uHomePlanCreateBtnA").click(function(){
		if($(".uPlan").eq(0).attr("planType") != undefined) {
			alertDialog("只能创建一个计划");
		 	return;
		}
		fnCreatePopBox({
           title:'创建房租计划',
           divContent:'<form class="form-inline" id="uHomePlanCreateForm" action="/UHomeOperator.action?createUHomePlan" method="post"> <div class="form-control"> <label>计划类型：</label> <input type="radio" name="uHomePlan.type" value="A" checked="checked" id="APlan" /> <label for="APlan" class="text">散付计划</label> <input type="radio" name="uHomePlan.type" value="B" id="BPlan" /> <label for="BPlan" class="text">年付计划</label> </div> <div class="form-control"> <label for="price">月租金：</label> <input type="text" name="uHomePlan.amount" id="amount" placeholder="金额" class="input-units-5" datatype="n3-5" nullmsg="请输入租金" errormsg="请输入3-5位整数" sucmsg=" " /> <p class="form-control-static">元</p> <span class="valid Validform_checktip"></span> </div> <div class="form-control"> <label for="payType">交租方式：</label> <select name="uHomePlan.payType" id="payType"> <option value="1">月付</option> <option value="2">双月付</option> <option value="3">季付</option> <option value="6">半年付</option> </select> </div> <div class="form-control"> <label for="rentalMonth">租期：</label> <select name="uHomePlan.rentalMonth" id="rentalMonth"> <option value="1">1个月</option><option value="1">1个月</option><option value="2">2个月</option><option value="3">3个月</option><option value="4">4个月</option><option value="5">5个月</option><option value="6">6个月</option><option value="7">7个月</option><option value="8">8个月</option><option value="9">9个月</option><option value="10">10个月</option><option value="11">11个月</option><option value="12">12个月</option> </select> </div> <div class="form-control"> <label for="datepicker">首次交租：</label> <input type="text" name="uHomePlan.payDate" id="datepicker" placeholder="选择日期" class="input-units-6" datatype="*" readonly="" nullmsg="请选择付款日期" errormsg="请选择今天以后的日期" sucmsg=" " /> <span class="valid Validform_checktip"></span> </div> <div class="btn-group"> <button type="submit" class="btn btn-primary btn-only" > 确定 </div> </form>',
           className:'uHomePlanCreateBox divPop-lg',
           removeThis:false,
           confirmBtn:false
       });
       $("#payType").change(function() {
			$("#rentalMonth").empty();
			var payType = parseInt($("#payType").val());
			for (var m = payType; m <= 12; m+=payType) {
				$("#rentalMonth").append("<option value='"+m+"'>"+m+"个月</option>");
			}
			$("#rentalMonth").blur();
       });
       $("#APlan").click(function() {
    	   $("#payType").parent().show();
    	   $("#rentalMonth").parent().show();
    	   $("#datepicker").prev().text("首次交租：");
    	   $("#datepicker").datepicker("option", "minDate", 0);
       });
       $("#BPlan").click(function() {
    	   $("#payType").parent().hide();
    	   $("#rentalMonth").parent().hide();
    	   $("#datepicker").prev().text("交租日期：");
    	   $("#datepicker").datepicker("option", "minDate", 366);
       });
       // 初始化日期控件
       $("#datepicker").datepicker({
   	    	changeMonth: true,
   	    	changeYear: true,
	   		dateFormat: "yy-mm-dd",
	   		minDate: 0, // 最小日期与今天差0天，也就是今天以后
	   		onSelect: function(selectedDate){
	   			$("#datepicker").siblings(".Validform_checktip").html("").removeClass("Validform_wrong");
	   		}
       });
       
       // 创建计划 提交表单
       $("#uHomePlanCreateForm").Validform({
			ajaxPost:true,
			postonce:true,
			tiptype:4,
			datatype:{
				"virRentalMonth":function(gets,obj,curform,regxp){
					if(/^\d{1,2}$/.test(gets) && parseInt(gets) >= 1 && parseInt(gets) <= 12 ){return true;}
					return false;
				}
			},
			beforeSubmit:function(curform){
				$(":submit").text('创建中...');
				$(":submit").attr("disabled", "true");
				$(":submit").addClass("forbidden");
			},
			callback:function(data){
				if(data.status === undefined || String(data.status) != '1'){
					$(":submit").text('确定');
					$(":submit").removeAttr("disabled");
					$(":submit").removeClass("forbidden");
				}
				// 未登录
				if(data.logined != undefined && data.logined == 'n'){
					$("#loginBtn").click();
					return ;
				}
				switch (String(data.status)) {
					case '1': // 成功
						window.location.reload();
						break;
					case '0': // 失败
						alertDialog(data.info);
						break;
					case '2': // 租金不合法
						alertDialog(data.info);
						break;
					case '3': // 付款方式不合法
						alertDialog(data.info);
						break;
					case '4': // 付款日期不合法
						alertDialog(data.info);
						break;
					default:
						alertDialog(data.info);
						break;
				}
			}
		});
   });
	
	$("#toChummagehouse").click(function() {
		var depositUrl = $(this).attr("url");
		// 未了解
		if($.cookie("isee") === undefined || $.cookie("isee")!=1){
			// 协议弹出层
			fnCreatePopBox({
				title:'U房宝份额转账服务协议',
				divContent: prot ,
				className:'divPop-max protocolBox',
				confirmBtn: false
			});
			// 我已了解点击事件
			$("#isee").click(function() {
				$.cookie("isee", 1, {expires:30});
				window.location.href=depositUrl;
			});
		}
		// 已了解过
		else{
			window.location.href=depositUrl;
		}
	});
	// 删除计划
	$(".removePlan").click(function() {
		var planType = $(this).parents(".uPlan").attr("planType");
		var planNum = $(this).parents(".uPlan").attr("planNum");
		var delBtn = $(this);
		// 判断是否存入金额到计划中
		$.ajax({
			url: "/UHomeOperator.action?isDepositMoneyInPlan",
			data: {
				planType: planType,
				planNum: planNum
			},
			dataType: "json",
			async: true,
			type: "post",
			cache: false,
			success: function(data) {
				// 未登录
				if(data.logined != undefined && data.logined == 'n'){
					$("#loginBtn").click();
					return ;
				}
				// 还没有向计划存钱，可删除
				if(data.status == '0'){
					// 确认删除
					confirmDialog("确定删除计划吗？", function() {
						// 执行删除
						$.ajax({
							url: "/UHomeOperator.action?terminateUHomePlan",
							data: {
								planType: planType,
								planNum: planNum
							},
							dataType: "json",
							async: true,
							type: "post",
							cache: false,
							success: function(data) {
								// 未登录
								if(data.logined != undefined && data.logined == 'n'){
									$("#loginBtn").click();
									return ;
								}
								// 删除成功
								if(data.status == '1'){
									delBtn.parents(".uPlan").remove();
								}else if(data.status == '2'){
									alertDialog("先赎回全部金额才可删除计划！");
								}
							},
							error: function(error){
								alertDialog("系统异常，请稍后再试");
							}
						});
					});
				}
				// 已存入金额到计划中，不可删除
				else{
					alertDialog(data.info);
				}
			},
			error: function(error){
				alertDialog("系统异常，请稍后再试");
			}
		});
	});
	
	// 添加房东
	$("#addHouseOwner").click(function() {
		var btn = $(this);
		var planType = $(this).parents(".uPlan").attr("planType");
		var planNum = $(this).parents(".uPlan").attr("planNum");
		fnCreatePopBox({
			title:'填写房东信息 <q>（请确认房东已在U房宝开户）</q>',
           divContent:'<form class="form-inline" id="addHouseOwnerForm" action="/UHomeOperator.action?addHouseOwner" method="post"> <input type="hidden" name="planType" value="'+planType+'"><input type="hidden" name="planNum" value="'+planNum+'"> <div class="form-control"> <label for="realname">房东姓名</label> <input type="text" name="realname" id="realname" placeholder="姓名" datatype="s" nullmsg="请输入姓名" errormsg="请输入合法的姓名" sucmsg=" "> <span class="valid Validform_checktip" style="height: 10px; line-height: 20px; margin-left: 95px;"></span> </div> <div class="form-control"> <label for="cardNo">银行卡号</label> <input type="text" name="cardNo" id="cardNo" placeholder="卡号" datatype="n" nullmsg="请输入银行卡号" errormsg="请输入正确的银行卡号" sucmsg=" "> <span class="valid Validform_checktip" style="height: 10px; line-height: 20px; margin-left: 95px;"></span> </div>  </form>',
           className:'addHouseOwnerBox',
           removeThis:false,
           fn:function(){
        	   $("#addHouseOwnerForm").submit();
           }
		});
		
		// 表单验证和提交后的回调
		$("#addHouseOwnerForm").Validform({
			ajaxPost:true,
			postonce:true,
			tiptype:4,
			beforeSubmit:function(curform){
				$(".addHouseOwnerBox .confirmBtn").text('提交中...');
				$(".addHouseOwnerBox .confirmBtn").attr("disabled", "true");
				$(".addHouseOwnerBox .confirmBtn").addClass("forbidden");
			},
			callback:function(data){
				$(".addHouseOwnerBox .confirmBtn").text('确定');
				$(".addHouseOwnerBox .confirmBtn").removeAttr("disabled");
				$(".addHouseOwnerBox .confirmBtn").removeClass("forbidden");
				
				// 未登录
				if(data.logined != undefined && data.logined == 'n'){
					$("#loginBtn").click();
					return ;
				}
				switch (data.status) {
					case '1': // 成功
						$("#addHouseOwner").after("<label id='houseOwnerInfo'>"+$("#realname").val()+"（尾号"+$("#cardNo").val().substring($("#cardNo").val().length-4, $("#cardNo").val().length)+"）</label>");
						$("#addHouseOwner").remove();
						$("#editHouseOwner").click(editHouseOwner);
						$(".addHouseOwnerBox").remove();
						CoverLayer(0);
						alertSetTime(data.info, 1000);
						break;
					case '-1': // 非法请求
						alertDialog(data.info);
						break;
					case '2': // 姓名不合法
						$("#realname").siblings(".Validform_checktip").html(data.info).addClass("Validform_wrong");
						break;
					case '3': // 银行卡不合法
					case '4': // 房东未开户
					case '5': // 不能设置本人为房东
					case '6': // 已设置房东
						$("#cardNo").siblings(".Validform_checktip").html(data.info).addClass("Validform_wrong");
						break;
					default:
						$("#cardNo").siblings(".Validform_checktip").html(data.info).addClass("Validform_wrong");
						break;
				}
			}
		});
	});
	
	// 设置自动转账
	$("#transfer").click(function() {
		var planType = $(this).parents(".uPlan").attr("planType");
		var planNum = $(this).parents(".uPlan").attr("planNum");
		$("#transfer").prop("checked", !this.checked);
		if($("#houseOwnerInfo").length == 0){
			confirmDialog("添加房东后才能设置自动转账，要添加房东吗？", function() {
				$("#addHouseOwner").click();
			});
			return;
		}
		var content = "";
		var transferFlag;
		var tOrF;
		// 开启
		if(!this.checked){
			content = "确定自动转账给房东吗？";
			transferFlag = 2;
			tOrF = true;
		}
		// 取消
		else {
			content = "确定取消自动转账功能吗？";
			transferFlag = 1;
			tOrF = false;
		}
		confirmDialog(content, function() {
			$.ajax({
				url: "/UHomeOperator.action?setAutoTransfer",
				data: {
					planType: planType,
					planNum: planNum,
					transfer: transferFlag
				},
				dataType: "json",
				async: true,
				type: "post",
				cache: false,
				success: function(data) {
					// 未登录
					if(data.logined != undefined && data.logined == 'n'){
						$("#loginBtn").click();
						return ;
					}
					// 成功
					if(data.status == '1'){
						$("#transfer").prop("checked", tOrF);
						alertSetTime("设置成功", 1000);
					}else if(data.status == '0'){
						alertSetTime("设置失败", 1000);
					}else{
						alertDialog(data.info);
					}
				},
				error: function(error){
					alertDialog("系统异常，请稍后再试");
				}
			});
		});
   });
	
	// 修改房东
//	$("#editHouseOwner").click(editHouseOwner);
	
	// 日期控件中文配置
	$.datepicker.setDefaults({
		monthNamesShort : [ "1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月" ],
		dayNamesMin : [ "日", "一", "二", "三", "四", "五", "六" ],
		dateFormat : "yy-mm-dd",
		firstDay : 1,
		showMonthAfterYear : true
	});
});

function editHouseOwner() {
	var btn = $(this);
	var planType = $(this).parents(".uPlan").attr("planType");
	var planNum = $(this).parents(".uPlan").attr("planNum");
	fnCreatePopBox({
       title:'填写房东信息',
       divContent:'<form class="form-inline" id="editHouseOwnerForm" action="/UHomeOperator.action?editHouseOwner" method="post"> <input type="hidden" name="planType" value="'+planType+'"><input type="hidden" name="planNum" value="'+planNum+'"> <div class="form-control"> <label for="realname">房东姓名</label> <input type="text" name="realname" id="realname" placeholder="姓名" datatype="s" nullmsg="请输入姓名" errormsg="请输入合法的姓名" sucmsg=" "> <span class="valid Validform_checktip" style="height: 10px; line-height: 20px; margin-left: 95px;"></span> </div> <div class="form-control"> <label for="cardNo">银行卡号</label> <input type="text" name="cardNo" id="cardNo" placeholder="卡号" datatype="n" nullmsg="请输入银行卡号" errormsg="请输入正确的银行卡号" sucmsg=" "> <span class="valid Validform_checktip" style="height: 10px; line-height: 20px; margin-left: 95px;"></span> </div>  </form>',
       className:'editHouseOwnerBox',
       removeThis:false,
       fn:function(){
    	   $("#editHouseOwnerForm").submit();
       }
	});
	
	// 表单验证和提交后的回调
	$("#editHouseOwnerForm").Validform({
		ajaxPost:true,
		postonce:true,
		tiptype:4,
		callback:function(data){
			// 未登录
			if(data.logined != undefined && data.logined == 'n'){
				$("#loginBtn").click();
				return ;
			}
			switch (data.status) {
				case '1': // 成功
					removePop(btn);
					alertDialog(data.info);
					break;
				case '-1': // 非法请求
					alertDialog(data.info);
					break;
				case '2': // 姓名不合法
					$("#realname").siblings(".Validform_checktip").html(data.info).addClass("Validform_wrong");
					break;
				case '3': // 银行卡不合法
					$("#cardNo").siblings(".Validform_checktip").html(data.info).addClass("Validform_wrong");
					break;
				case '4': // 房东未开户
					alertDialog(data.info);
					break;
				case '5': // 不能设置本人为房东
					alertDialog(data.info);
					break;
				default:
					alertDialog(data.info);
					break;
			}
		}
	});
}


